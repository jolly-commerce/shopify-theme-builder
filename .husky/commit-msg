#!/bin/sh

# The commit message file is passed as $1
COMMIT_MSG_FILE="$1"

# Show commit message
if [ -f "$COMMIT_MSG_FILE" ]; then
  echo "ğŸ“ Commit message:"
  echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
  cat "$COMMIT_MSG_FILE"
  echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
fi

# Check for --skip-theme-check flag in commit message
if grep -q "\-\-skip-theme-check" "$COMMIT_MSG_FILE"; then
  echo "ğŸš« Found --skip-theme-check flag in commit message"
  echo "âš ï¸  WARNING: Theme check will be SKIPPED!"
  echo "âœ… Proceeding without theme check..."
  exit 0
fi

# Run theme check
echo "ğŸ” Running Shopify theme check..."
if ! shopify theme check; then
  echo "âŒ Theme check failed. Commit aborted."
  echo "âš ï¸ To bypass the check (not recommended), use: git commit --no-verify"
  exit 1
fi

echo "âœ… Theme check passed. Commit proceeding..." 